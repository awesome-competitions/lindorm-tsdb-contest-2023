package com.alibaba.lindorm.contest.v2.tests;

import com.alibaba.lindorm.contest.v2.Context;
import com.alibaba.lindorm.contest.v2.codec.*;

import java.nio.ByteBuffer;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class TestDouble {

    public static void main(String[] args) {

       double[][] numbersList = new double[][]{
           {20155.051924321,20155.051990041367,20155.05205784809,20155.052127741168,20155.0521997206,20155.05227378639,20155.05234993853,20155.052428177023,20155.052508501867,20155.052590913063,20155.05267541061,20155.05276199451,20155.052850664757,20155.052941421352,20155.053034264296,20155.053129193588,20155.053226209224,20155.053325311208,20155.05342649954,20155.053529774214,20155.05363513523,20155.05374258259,20155.053852116293,20155.053963736336,20155.05407744272,20155.054193235443,20155.054311114505,20155.054431079905,20155.054553131642,20155.054677269716,20155.054803494124,20155.054931804865,20155.055062201936,20155.055194685345,20155.055329255083,20155.055465911148,20155.055604653546,20155.05574548227,20155.05588839732,20155.056180486397,20155.056033398698,20155.056329660423,20155.05648092077,20155.05663426744,20155.056789700426,20155.056947219735,20155.05710682536,20155.0572685173,20155.057432295558,20155.05759816013,20155.05776611101,20155.057936148205,20155.05810827171,20155.058282481525,20155.058458777643,20155.058637160073,20155.058817628804,20155.05900018384,20155.059184825175,20155.059371552812,20155.059751266985,20155.05956036675,20155.059944253517,20155.060139326342,20155.06033648546,20155.060535730874,20155.060737062573,20155.060940480565,20155.06114598484},
           {20155.05189745686,20155.051963177233,20155.052030983963,20155.05210087705,20155.05217285649,20155.05224692228,20155.05232307443,20155.052401312932,20155.052481637784,20155.052564048987,20155.052648546545,20155.052735130448,20155.052823800706,20155.05291455731,20155.053007400264,20155.053102329563,20155.053199345213,20155.053298447205,20155.053399635544,20155.05350291023,20155.053608271257,20155.053715718626,20155.05382525234,20155.053936872395,20155.05405057879,20155.054166371523,20155.0542842506,20155.05440421601,20155.05452626776,20155.054650405844,20155.054776630262,20155.05490494102,20155.055035338104,20155.055167821523,20155.055302391273,20155.055439047355,20155.055577789764,20155.055718618503,20155.05586153357,20155.056153622674,20155.05600653496,20155.056302796715,20155.056454057078,20155.05660740376,20155.056762836764,20155.056920356084,20155.057079961727,20155.05724165368,20155.057405431955,20155.057571296544,20155.05773924744,20155.057909284653,20155.058081408173,20155.058255618005,20155.05843191414,20155.058610296586,20155.05879076534,20155.058973320392,20155.059157961747,20155.0593446894,20155.05972440361,20155.059533503358,20155.05991739016,20155.060112463005,20155.060309622146,20155.060508867577,20155.060710199297,20155.060913617308,20155.061119121605},
           {20155.051807846805,20155.05187148083,20155.051937201213,20155.05200500795,20155.05207490104,20155.052146880487,20155.05222094629,20155.052297098446,20155.052375336953,20155.05245566181,20155.052538073025,20155.052622570587,20155.0527091545 ,20155.052797824766,20155.05288858138,20155.052981424342,20155.05307635365,20155.05317336931,20155.053272471312,20155.05337365966,20155.053476934354,20155.053582295393,20155.053689742774,20155.053799276495,20155.05391089656,20155.054024602967,20155.054140395714,20155.0542582748 ,20155.05437824022,20155.054500291983,20155.05462443008,20155.054750654508,20155.054878965275,20155.055009362375,20155.055141845805,20155.05527641557,20155.055413071663,20155.055551814086,20155.05569264284,20155.055835557916,20155.05612764705,20155.055980559322,20155.056276821106,20155.05642808148,20155.05658142818,20155.056736861196,20155.056894380534,20155.05705398619,20155.057215678164,20155.05737945645,20155.057545321055,20155.05771327197,20155.057883309197,20155.058055432735,20155.058229642582,20155.058405938737,20155.0585843212 ,20155.058764789963,20155.058947345035,20155.059131986407,20155.05931871408,20155.059698428326,20155.059507528054,20155.059891414894,20155.06008648776,20155.060283646915,20155.060482892364,20155.060684224107,20155.060887642136,20155.06109314645}
       };

        DeltaOfDeltaBDFCMCodec codec = new DeltaOfDeltaBDFCMCodec();
        ZSTDCodec zstdCodec = new ZSTDCodec();

        ByteBuffer encodedBuffer = ByteBuffer.allocateDirect(300000);
        int count = 0;
        for (double[] numbers: numbersList){
            codec.encode(encodedBuffer, numbers, numbers.length);
            count+= numbers.length;
        }
        encodedBuffer.flip();

        ByteBuffer dstBuffer = ByteBuffer.allocateDirect(300000);
        zstdCodec.encode(dstBuffer, encodedBuffer, 0);
        dstBuffer.flip();


        System.out.println(dstBuffer.remaining());
        System.out.println(count * 8);






    }
}
